<div id="map" style="width: 100%; height: 100vh;"></div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        async function loadNaverMap() {
            try {
                const response = await fetch("/api/naver/map/proxy-maps");
                const scriptText = await response.text();

                if (!scriptText.includes("naver.maps")) {
                    throw new Error("ğŸ“Œ ë„¤ì´ë²„ ë§µ API ë¡œë“œ ì‹¤íŒ¨ (naver ê°ì²´ ì—†ìŒ)");
                }

                const script = document.createElement("script");
                script.text = scriptText;
                document.body.appendChild(script);

                script.onload = function () {
                    console.log("âœ… Naver Map API ë¡œë“œ ì™„ë£Œ");
                    if (typeof window.initMap === "function") {
                        window.initMap();
                    }
                };

            } catch (error) {
                console.error(error.message);
            }
        }

        window.initMap = function () {
            if (typeof naver === "undefined") {
                console.error("ğŸ“Œ ë„¤ì´ë²„ ë§µ API ë¡œë“œ ì‹¤íŒ¨ (naver ê°ì²´ ì—†ìŒ)");
                return;
            }

            let map = new naver.maps.Map('map', {
                center: new naver.maps.LatLng(37.3595704, 127.105399),
                zoom: 13
            });

            // ğŸ¯ ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ passive ëª¨ë“œë¡œ ì„¤ì •
            document.addEventListener('mousewheel', function (event) {}, { passive: true });
            document.addEventListener('touchmove', function (event) {}, { passive: true });

            console.log("âœ… Naver Map Initialized");
        };

        // âœ… documentê°€ ë¡œë“œëœ í›„ ì‹¤í–‰
        loadNaverMap();
    });

</script>